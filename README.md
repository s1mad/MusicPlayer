# Тестовое задание


## Выполнено:
- Поиск и воспроизведение музыки через [Deezer API](https://developers.deezer.com/api).
- Воспроизведение локальных треков с поиском по ним.
- Управление воспроизведением: пауза, воспроизведение, перемотка, переход к следующему/предыдущему треку.
- Фоновое воспроизведение с уведомлением.
- В приложении есть функция перемещения между музыкальными композициями внутри альбома в фоновом режиме (через уведомление).
- Навигация между экранами с помощью BottomNavigation.
- Многомодульная Clean архитектура
- DI – Dagger
- Покрытие кода юнит-тестами


## Модули
- :app — основной модуль приложения.
- :data — работа с данными (API, локальное хранилище).
- :domain — бизнес-логика.
- :presentation:core — общая логика для экранов.
- :presentation:remote-tracks — экран треков из API.
- :presentation:local-tracks — экран локальных треков.
- :presentation:player — экран воспроизведения.


## Стэк:
- **Язык**: Kotlin
- **Архитектура**: MVI (через ViewModel)
- **UI**: Jetpack Compose
- **Навигация**: Compose Navigation
- **Сеть**: Retrofit
- **Многопоточность**: Kotlin Coroutines, Flow
- **Сериализация**: Kotlinx Serialization
- **DI**: Dagger 2
- **Медиа**: Media3
- **Тестирование**: Mockito, Turbine, JUnit


## Ветки
- feature/local-tracks — разработка экрана локальных треков.
- feature/remote-tracks — разработка экрана треков из API.
- feature/player — разработка экрана воспроизведения.
- main — финальная версия приложения.


## Инструкция по запуску
1. Склонируйте репозиторий: `git clone https://github.com/s1mad/MusicPlayer.git`
2. Запустите приложение на устройстве или эмуляторе (API 24+).


## Проблемы и их решения


### Dagger 2 с ViewModel:
- **Проблема**: Отсутствовала практика с Dagger, поэтому пришлось поискать информацию о том как реализовать, то что в Hilt уже реализовно. Возникли сложности с настройкой фабрики ViewModel и привязкой ViewModel к DI.
- **Решение**: Изучил документацию Dagger и примеры. Реализовал модуль ViewModelModule с аннотациями @Binds и @IntoMap для привязки ViewModel. Использовал кастомную фабрику ViewModelFactory для создания экземпляров ViewModel. Это позволило корректно и очень легко интегрировать ViewModel с Dagger.


### Media3:
- **Проблема**: Не было опыта работы с Media3, настройка и изучение документации заняли время.
- **Решение**: Прочитал официальную документацию и статьи по Media3. Реализовал воспроизведение с использованием ExoPlayer и интегрировал его с уведомлением для фонового режима.
- **Дополнительная проблема**: Создал два уведомления (кастомное и дефолтное от Media3), но не мог отключить дефолтное уведомление.
- **Решение**: Выяснил, что дефолтное уведомление Media3 отключить нельзя. Удалил кастомное уведомление и адаптировал дефолтное).
